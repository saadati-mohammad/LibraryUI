<!-- book-page.component.html -->
<div class="page-container">

  <div class="page-main-header">
    <h1 class="page-main-title">مدیریت <span>امانت ها</span></h1>
    <!-- Optional: User profile or theme toggle button can go here -->
  </div>

  <div class="content-card">
    <div class="content-card-header">
      <div class="filters-section">
      </div>
      <div class="actions-section">
        <button mat-raised-button color="primary" class="btn btn-primary" (click)="openAddBookModal()">
          <mat-icon>add_circle_outline</mat-icon>
          افزودن امانت جدید
        </button>
      </div>
    </div>

    <div class="content-card-body">
      <app-list [tableTitle]="tableTitle" [columns]="columns" [data]="data" [showPaginator]="false"
        [pageSizeOptions]="[]">
      </app-list>
    </div>
  </div>

</div>

<!-- Modal for adding book (app-modal) -->
<app-modal [(isVisible)]="isAddBookModalVisible" title="افزودن" titleAccent="کتاب جدید" submitButtonText="ذخیره کتاب"
  submitButtonIcon="save" (submit)="onAddBookSubmit()" (cancel)="onAddBookModalClose()"
  [disableSubmit]="addBookForm.invalid || isSubmitting" [isLoading]="isSubmitting" maxWidth="700px">
  <div modal-body>
    <p>لطفاً اطلاعات کتاب جدید را وارد کنید:</p>
    <form [formGroup]="addBookForm" id="addBookInternalForm">
      <div class="form-grid">
        <div class="form-group">
          <label for="bookTitle">عنوان کتاب <span class="required-star">*</span></label>
          <input type="text" id="bookTitle" formControlName="bookTitle" class="form-control"
            placeholder="مثال: شازده کوچولو">
        </div>
        <div class="form-group">
          <label for="bookAuthor">نویسنده <span class="required-star">*</span></label>
          <input type="text" id="bookAuthor" formControlName="bookAuthor" class="form-control"
            placeholder="مثال: آنتوان دوسنت اگزوپری">
        </div>
      </div>
      <div class="form-grid">
        <div class="form-group">
          <label for="bookCategory">دسته‌بندی <span class="required-star">*</span></label>
          <select id="bookCategory" formControlName="bookCategory" class="form-control">
            <option value="" disabled>یک دسته‌بندی انتخاب کنید...</option>
            <!-- Removed selected attribute, rely on formControl -->
            <option value="roman">رمان</option>
            <option value="tarikhi">تاریخی</option>
            <option value="elmi">علمی</option>
          </select>
        </div>
        <div class="form-group">
          <label for="bookCopies">تعداد نسخه‌ها <span class="required-star">*</span></label>
          <input type="number" id="bookCopies" formControlName="bookCopies" class="form-control" min="1">
          <!-- Removed value="1", rely on formControl -->
        </div>
      </div>
      <div class="form-group">
        <label for="bookCover">تصویر جلد</label>
        <div class="form-control-file-wrapper">
          <input type="file" id="bookCover" (change)="onFileChange($event)" class="form-control fileInput"
            accept="image/*"> <!-- fileInput class is for hiding if needed -->
          <label for="bookCover" class="form-control-file-button" role="button" tabindex="0">انتخاب فایل</label>
          <span class="form-control-file-text">{{ selectedFileName || 'هیچ فایلی انتخاب نشده' }}</span>
        </div>
        <small *ngIf="fileError" class="file-error-message">{{ fileError }}</small>
      </div>
    </form>
  </div>
</app-modal>